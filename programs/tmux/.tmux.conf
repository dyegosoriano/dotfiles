
unbind r                                          # Remove o atalho 'r' caso já esteja definido
bind r source-file ~/.tmux.conf                   # Define 'r' como atalho para recarregar a config do tmux

# GERAL
set-window-option -g mode-keys vi                 # Define navegação no estilo do Vim dentro do tmux
set -g default-command "fish -i"                  # Usa fish interativo que carrega todas as configurações
set -g detach-on-destroy off                      # Não encerra o tmux ao fechar uma sessão
set -g history-limit 1000000                      # Aumenta o histórico (de 2.000 para 1.000.000)
set -g status-interval 10                         # Atualizar a barra de status a cada 10 segundos (padrão: 15 segundos)
set -g prefix C-Space                             # Troca o prefixo padrão (Ctrl-b) para Ctrl-espaço
set -g mouse on                                   # Ativa suporte ao mouse (rolagem, seleção, redimensionar painéis)

# Ajustes no suporte de cores do terminal
set -ag terminal-overrides ",xterm-256color:RGB"  # Ativa suporte a cores RGB no terminal
set -g default-terminal "tmux-256color"           # Define terminal padrão como "tmux-256color" para melhor compatibilidade

# Painéis
bind h split-window -v -c "#{pane_current_path}"  # Divide painel na horizontal no mesmo diretório
bind v split-window -h -c "#{pane_current_path}"  # Divide painel na vertical no mesmo diretório
bind c new-window -c "#{pane_current_path}"       # Cria nova janela no mesmo diretório
set -g pane-base-index 1                          # Começar numeração de painéis a partir do 1
set -g base-index 1                               # Começar numeração de janelas a partir do 1 (não 0)

# Use Alt + setas para mudar de painel sem prefixo (desativado quando no Neovim)
bind -n M-Right if -F '#{==:#{pane_current_command},nvim}' 'send-keys M-Right' 'select-pane -R' # Alt+→ muda para painel da direita
bind -n M-Left if -F '#{==:#{pane_current_command},nvim}' 'send-keys M-Left' 'select-pane -L'   # Alt+← muda para painel da esquerda
bind -n M-Down if -F '#{==:#{pane_current_command},nvim}' 'send-keys M-Down' 'select-pane -D'   # Alt+↓ muda para painel de baixo
bind -n M-Up if -F '#{==:#{pane_current_command},nvim}' 'send-keys M-Up' 'select-pane -U'       # Alt+↑ muda para painel de cima

# Use Shift + setas para mudar de janela
bind -n S-Left previous-window                    # Shift+← vai para janela anterior
bind -n S-Right next-window                       # Shift+→ vai para próxima janela

# Plugins
set -g @plugin 'tmux-plugins/tpm'                 # Gerenciador de plugins TPM
set -g @plugin 'christoomey/vim-tmux-navigator'   # Integra navegação entre tmux e Vim
set -g @plugin 'tmux-plugins/tmux-icons'          # Habilita ícones na barra de status

# Tema Catppuccin
set -g @plugin 'catppuccin/tmux'                  # Tema Catppuccin
set -g @catppuccin_flavor 'mocha'                 # Define variação "mocha"

# Status line
set -g status-justify "absolute-centre"           # Centraliza os itens na status line
set -g status-position bottom                     # Coloca a barra de status na parte inferior

# Status left
set -g status-left ""                                                                                                             # Limpa status-left inicial
set -ga status-left "#{?client_prefix,#{#[bg=#{@thm_red},fg=#{@thm_bg},bold]  #S },#{#[bg=#{@thm_bg},fg=#{@thm_green}]  #S }}"  # Mostra nome da sessão e destaca se prefixo ativo
set -ga status-left "#[bg=#{@thm_bg},fg=#{@thm_blue}]  #{=/-32/...:#{s|$USER|~|:#{b:pane_current_path}}} "                       # Mostra caminho da pasta atual
set -ga status-left "#[bg=#{@thm_bg},fg=#{@thm_maroon}]  #{pane_current_command} "                                               # Mostra comando atual no painel
set -ga status-left "#[bg=#{@thm_bg},fg=#{@thm_overlay_0},none]#{?window_zoomed_flag,│,}"                                         # Mostra separador se janela estiver em zoom
set -ga status-left "#[bg=#{@thm_bg},fg=#{@thm_yellow}]#{?window_zoomed_flag,  zoom ,}"                                          # Indica se o painel está em zoom

# Status right
set -g status-right ""                                                            # Limpa status-right inicial
set -ga status-right "#[bg=#{@thm_mantle},fg=#{@thm_blue}] 󰅐 %H:%M 󰭦 %d/%m/%Y "   # Mostra hora e data

# Estilo das janelas
set -wg automatic-rename on                                                                                         # Renomeia janelas automaticamente baseado no processo ativo
set -g automatic-rename-format ''                                                                                   # Remove formato padrão de renomeação
set -g window-status-separator '|'                                                                                  # Define separador de janelas como "|"
set -g status-justify 'absolute-centre'                                                                             # Centraliza nomes das janelas
set -g @catppuccin_window_status_style 'custom'                                                                     # Aplica estilo customizado no tema
set -g @catppuccin_window_flags ""                                                                                  # Remove flags extras
set -g @catppuccin_window_number ""                                                                                 # Oculta número da janela
set -g @catppuccin_window_text "#[fg=#{@thm_rosewater},bg=#{@thm_mantle}] #I#{?#{!=:#{window_name},},: #W ,}"       # Texto da janela normal
set -g @catppuccin_window_current_number ""                                                                         # Oculta número da janela atual
set -g @catppuccin_window_current_text "#[fg=#{@thm_mantle},bg=#{@thm_peach}] #I#{?#{!=:#{window_name},},: #W ,}"   # Texto da janela atual

run '~/.tmux/plugins/tpm/tpm'                  # Executa o TPM para carregar os plugins
